import{am as Q,an as pe,p as x,k as H,x as P,ao as Pe,n as dt,G as ft,f as k,C as vt,y as pt,ap as yt,r as V,D as U,d as ee,c as n,e as f,u as g,b as ue,a2 as G,a5 as Oe,aq as K,w as m,h as $,M as D,g as j,t as h,W as A,j as y,ar as ht,Z,V as q,O as bt,N as gt,_ as wt,X as kt,i as ce,Y as St,a as Se,s as O,K as z,o as It,S as Ie,ak as $t,F as $e}from"./index-CQHe9KB5.js";import{V as Te,M as Le,v as Ne,q as Me,c as J,u as De,f as Ct,l as me,w as Bt,p as Ce,k as _t}from"./VCheckbox-_eVssUuR.js";import{_ as Vt}from"./eventbus-CxBHXMjo.js";import{L as At}from"./ListItem-BlTvbW6N.js";import{B as Re}from"./Button-C2tPqXAJ.js";import{d as Ft,b as Pt,c as de,f as Ot}from"./VMenu-C_g4AWFG.js";import{m as ye,b as he,h as Tt,o as Lt,t as Nt,v as Mt,c as Dt,w as Y,y as Rt,A as Et,B as W,V as jt,s as fe}from"./VListItem-932LEcae.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Kt,a as Gt}from"./VCard-BBArKN8n.js";import{V as Yt}from"./VSpacer-BB-V2OH5.js";import{V as Xt,P as Ut}from"./PanelviewItemCompact-C9xC4OzX.js";import{V as zt}from"./VAlert-CgwdfNK_.js";import{C as Ht}from"./Container-D0GZf7eO.js";import{T as Wt}from"./Toolbar-Bxz1a-Vc.js";import{V as qt}from"./VTextField-DJj81lxi.js";import{V as Jt}from"./VList-SeV0eskX.js";import{a as Zt,V as Qt}from"./VInfiniteScroll-tYOoNmCo.js";/* empty css              */import{V as xt}from"./VVirtualScroll-qRehF0qb.js";const Ee=Q.reduce((o,a)=>(o[a]={type:[Boolean,String,Number],default:!1},o),{}),je=Q.reduce((o,a)=>{const r="offset"+pe(a);return o[r]={type:[String,Number],default:null},o},{}),Ke=Q.reduce((o,a)=>{const r="order"+pe(a);return o[r]={type:[String,Number],default:null},o},{}),Be={col:Object.keys(Ee),offset:Object.keys(je),order:Object.keys(Ke)};function ea(o,a,r){let u=o;if(!(r==null||r===!1)){if(a){const l=a.replace(o,"");u+=`-${l}`}return o==="col"&&(u="v-"+u),o==="col"&&(r===""||r===!0)||(u+=`-${r}`),u.toLowerCase()}}const ta=["auto","start","end","center","baseline","stretch"],aa=x({cols:{type:[Boolean,String,Number],default:!1},...Ee,offset:{type:[String,Number],default:null},...je,order:{type:[String,Number],default:null},...Ke,alignSelf:{type:String,default:null,validator:o=>ta.includes(o)},...ye(),...he()},"VCol"),_e=H()({name:"VCol",props:aa(),setup(o,a){let{slots:r}=a;const u=P(()=>{const l=[];let d;for(d in Be)Be[d].forEach(S=>{const e=o[S],b=ea(d,S,e);b&&l.push(b)});const I=l.some(S=>S.startsWith("v-col-"));return l.push({"v-col":!I||!o.cols,[`v-col-${o.cols}`]:o.cols,[`offset-${o.offset}`]:o.offset,[`order-${o.order}`]:o.order,[`align-self-${o.alignSelf}`]:o.alignSelf}),l});return()=>{var l;return Pe(o.tag,{class:[u.value,o.class],style:o.style},(l=r.default)==null?void 0:l.call(r))}}}),be=["start","end","center"],Ge=["space-between","space-around","space-evenly"];function ge(o,a){return Q.reduce((r,u)=>{const l=o+pe(u);return r[l]=a(),r},{})}const la=[...be,"baseline","stretch"],Ye=o=>la.includes(o),Xe=ge("align",()=>({type:String,default:null,validator:Ye})),oa=[...be,...Ge],Ue=o=>oa.includes(o),ze=ge("justify",()=>({type:String,default:null,validator:Ue})),ia=[...be,...Ge,"stretch"],He=o=>ia.includes(o),We=ge("alignContent",()=>({type:String,default:null,validator:He})),Ve={align:Object.keys(Xe),justify:Object.keys(ze),alignContent:Object.keys(We)},sa={align:"align",justify:"justify",alignContent:"align-content"};function na(o,a,r){let u=sa[o];if(r!=null){if(a){const l=a.replace(o,"");u+=`-${l}`}return u+=`-${r}`,u.toLowerCase()}}const ra=x({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:Ye},...Xe,justify:{type:String,default:null,validator:Ue},...ze,alignContent:{type:String,default:null,validator:He},...We,...ye(),...he()},"VRow"),Ae=H()({name:"VRow",props:ra(),setup(o,a){let{slots:r}=a;const u=P(()=>{const l=[];let d;for(d in Ve)Ve[d].forEach(I=>{const S=o[I],e=na(d,I,S);e&&l.push(e)});return l.push({"v-row--no-gutters":o.noGutters,"v-row--dense":o.dense,[`align-${o.align}`]:o.align,[`justify-${o.justify}`]:o.justify,[`align-content-${o.alignContent}`]:o.alignContent}),l});return()=>{var l;return Pe(o.tag,{class:["v-row",u.value,o.class],style:o.style},(l=r.default)==null?void 0:l.call(r))}}}),qe=Symbol.for("vuetify:v-item-group"),ua=x({...ye(),...Tt({selectedClass:"v-item--selected"}),...he(),...dt()},"VItemGroup"),Je=H()({name:"VItemGroup",props:ua(),emits:{"update:modelValue":o=>!0},setup(o,a){let{slots:r}=a;const{themeClasses:u}=ft(o),{isSelected:l,select:d,next:I,prev:S,selected:e}=Lt(o,qe);return()=>k(o.tag,{class:["v-item-group",u.value,o.class],style:o.style},{default:()=>{var b;return[(b=r.default)==null?void 0:b.call(r,{isSelected:l,select:d,next:I,prev:S,selected:e.value})]}})}}),R=H()({name:"VItem",props:Nt(),emits:{"group:selected":o=>!0},setup(o,a){let{slots:r}=a;const{isSelected:u,select:l,toggle:d,selectedClass:I,value:S,disabled:e}=Mt(o,qe);return()=>{var b;return(b=r.default)==null?void 0:b.call(r,{isSelected:u.value,selectedClass:I.value,select:l,toggle:d,value:S.value,disabled:e.value})}}}),ca=x({id:String,text:String,...vt(Ft({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),ve=H()({name:"VTooltip",props:ca(),emits:{"update:modelValue":o=>!0},setup(o,a){let{slots:r}=a;const u=pt(o,"modelValue"),{scopeId:l}=Pt(),d=yt(),I=P(()=>o.id||`v-tooltip-${d}`),S=V(),e=P(()=>o.location.split(" ").length>1?o.location:o.location+" center"),b=P(()=>o.origin==="auto"||o.origin==="overlap"||o.origin.split(" ").length>1||o.location.split(" ").length>1?o.origin:o.origin+" center"),w=P(()=>o.transition?o.transition:u.value?"scale-transition":"fade-transition"),_=P(()=>U({"aria-describedby":I.value},o.activatorProps));return Dt(()=>{const L=de.filterProps(o);return k(de,U({ref:S,class:["v-tooltip",o.class],style:o.style,id:I.value},L,{modelValue:u.value,"onUpdate:modelValue":C=>u.value=C,transition:w.value,absolute:!0,location:e.value,origin:b.value,persistent:!0,role:"tooltip",activatorProps:_.value,_disableGlobalStack:!0},l),{activator:r.activator,default:function(){var E;for(var C=arguments.length,N=new Array(C),F=0;F<C;F++)N[F]=arguments[F];return((E=r.default)==null?void 0:E.call(r,...N))??o.text}})}),Ot({},S)}}),Ze=ee({__name:"FavoriteButton",props:{item:{}},setup(o){const a=o;return(r,u)=>{var l;return n(),f(Re,U(a,{variant:"list",icon:(l=r.item)!=null&&l.favorite?"mdi-heart":"mdi-heart-outline",title:r.$t("tooltip.favorite"),onClick:[u[0]||(u[0]=d=>g(ue).toggleFavorite(r.item)),u[1]||(u[1]=G(()=>{},["prevent"])),u[2]||(u[2]=G(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),ma={key:0,class:"media-thumb listitem-media-thumb"},da={key:1,class:"media-thumb listitem-media-thumb"},fa={key:0},va={key:1},pa={key:0},ya={key:0,class:"line-clamp-1"},ha={key:1},ba={key:0},ga={key:1},wa={key:2},ka={key:3},Sa={key:4},Ia={key:5},$a={key:2},Ca={key:3},Ba={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},_a=ee({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean}},emits:["menu","click","select"],setup(o,{emit:a}){const{t:r}=Oe(),u=o,l=P(()=>{if(!("provider_mappings"in u.item))return"";for(const e of u.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),d=a,I=function(e){const b="clientX"in e?e.clientX:e.touches[0].clientX,w="clientY"in e?e.clientY:e.touches[0].clientY;d("menu",u.item,b,w)},S=function(e){u.showCheckboxes||d("click",u.item,e.clientX,e.clientY)};return(e,b)=>(n(),f(At,{link:"","show-menu-btn":e.showMenu,onClick:G(S,["stop"]),onMenu:G(I,["stop"])},{prepend:m(()=>[e.showCheckboxes?(n(),$("div",ma,[k(Te,{"model-value":e.isSelected,onClick:b[0]||(b[0]=G(()=>{},["stop"])),"onUpdate:modelValue":b[1]||(b[1]=w=>{w!=null&&d("select",e.item,w)})},null,8,["model-value"])])):(n(),$("div",da,[k(Le,{size:"50",item:e.item},null,8,["item"])]))]),title:m(()=>[e.item.media_type==g(D).FOLDER?(n(),$("span",fa,[j("span",null,h(g(Ne)(e.item,g(r))),1)])):(n(),$("span",va,[A(h(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),$("span",pa,"("+h(e.item.version)+")",1)):y("",!0)])),e.item&&e.item.metadata?(n(),f(g(ve),{key:2,location:"bottom"},{activator:m(({props:w})=>[g(Me)(e.item.metadata.explicit||!1)?(n(),f(Y,U({key:0},w,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):y("",!0)]),default:m(()=>[j("span",null,h(e.$t("tooltip.explicit")),1)]),_:1})):y("",!0)]),subtitle:m(()=>[e.item.media_type==g(D).TRACK&&"provider_mappings"in e.item?(n(),$("div",ya,[k(Je,null,{default:m(()=>["artists"in e.item?(n(),f(R,{key:0},{default:m(()=>[A(h(g(J)(e.item.artists,2)),1)]),_:1})):y("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),f(R,{key:1},{default:m(()=>[A(" â€¢ "+h(e.item.album.name),1)]),_:1})):y("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(n(),f(R,{key:2},{default:m(()=>[k(Y,{style:{"margin-left":"5px"},icon:"md:album"}),A(" "+h(e.item.disc_number),1)]),_:1})):y("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),f(R,{key:3},{default:m(()=>[k(Y,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),A(" "+h(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(n(),f(R,{key:4},{default:m(()=>[k(Y,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),A(" "+h(e.item.position),1)]),_:1})):y("",!0)]),_:1})])):e.item.media_type==g(D).ALBUM&&"year"in e.item?(n(),$("div",ha,[e.item.album_type!=g(ht).UNKNOWN?(n(),$("span",ba,h(e.$t("album_type."+e.item.album_type))+" â€¢ ",1)):y("",!0),j("span",null,h(g(J)(e.item.artists)),1),e.item.year?(n(),$("span",ga," â€¢ "+h(e.item.year),1)):y("",!0)])):"artists"in e.item&&e.item.artists?(n(),$("div",wa,h(g(J)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),$("div",ka,h(e.item.owner),1)):e.item.media_type==g(D).RADIO&&e.item.metadata.description?(n(),$("div",Sa,h(e.item.metadata.description),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),$("div",Ia,h(e.$t(e.item.media_type)),1)):y("",!0)]),append:m(()=>[l.value?(n(),f(Rt,{key:0,src:g(De),width:"30",class:Z(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:m(()=>[k(g(ve),{activator:"parent",location:"bottom"},{default:m(()=>[A(h(l.value),1)]),_:1})]),_:1},8,["src","class"])):y("",!0),g(q)("bp2")&&e.showProvider?(n(),f(Vt,{key:1,domain:e.item.media_type==g(D).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):y("",!0),g(q)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(n(),$("div",$a,[k(Ze,{item:e.item},null,8,["item"])])):y("",!0),e.showDuration&&e.item.media_type==g(D).TRACK&&"duration"in e.item&&e.item.duration!=null&&g(q)("bp0")?(n(),$("div",Ca,[j("div",null,[j("span",Ba,h(g(Ct)(e.item.duration)),1)])])):y("",!0)]),_:1},8,["show-menu-btn"]))}}),Va=te(_a,[["__scopeId","data-v-8c542d22"]]),Aa={key:0},Fa={key:1},Pa={key:2},Oa=["src"],Ta={key:0},La=ee({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1}},emits:["menu","click","play","select"],setup(o,{emit:a}){const r=o,u=P(()=>{for(const e of r.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),l=a,d=function(e){if(r.showCheckboxes)return;const b="clientX"in e?e.clientX:e.touches[0].clientX,w="clientY"in e?e.clientY:e.touches[0].clientY;l("menu",r.item,b,w)},I=function(e){if(r.showCheckboxes){l("select",r.item,!r.isSelected);return}l("click",r.item,e.clientX,e.clientY)},S=function(e){r.showCheckboxes||l("play",r.item,e.clientX,e.clientY)};return(e,b)=>{const w=bt("hold");return n(),f(Xt,null,{default:m(({isHovering:_,props:L})=>[gt((n(),f(Kt,U(L,{tile:"",hover:"",class:"panel-item",onClick:I,onContextmenu:G(d,["right","prevent"])}),{default:m(()=>[e.showCheckboxes?(n(),f(de,{key:0,"model-value":e.showCheckboxes,contained:"",scrim:e.isSelected?e.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:m(()=>[k(Te,{class:"panel-item-checkbox",ripple:!1,"model-value":e.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):y("",!0),k(Le,{item:e.item,style:{height:"auto"}},null,8,["item"]),k(jt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:m(()=>[k(Et,null,{default:m(()=>[e.item.media_type==g(D).FOLDER?(n(),$("span",Aa,[j("span",null,h(g(Ne)(e.item,e.$t)),1)])):(n(),$("span",Fa,h(e.item.name),1)),"version"in e.item&&e.item.version?(n(),$("span",Pa," - "+h(e.item.version),1)):y("",!0)]),_:1}),"artists"in e.item&&e.item.artists?(n(),f(W,{key:0,class:"line-clamp-1"},{default:m(()=>[A(h(g(J)(e.item.artists,1)),1)]),_:1})):"owner"in e.item&&e.item.owner?(n(),f(W,{key:1,class:"line-clamp-1"},{default:m(()=>[A(h(e.item.owner),1)]),_:1})):e.showMediaType?(n(),f(W,{key:2,class:"line-clamp-1"},{default:m(()=>[A(h(e.$t(e.item.media_type)),1)]),_:1})):(n(),f(W,{key:3,class:"line-clamp-1"}))]),_:1}),(_||e.$vuetify.display.mobile)&&g(me)(e.item)?(n(),f(fe,{key:1,icon:"mdi-play",color:"primary",fab:"",style:wt(`position: absolute; right: 15px; bottom: ${e.showActions?90:35}px; opacity: 0.8`),onClick:G(S,["stop"])},null,8,["style"])):y("",!0),e.showActions?(n(),f(Gt,{key:2,class:"panel-item-actions"},{default:m(()=>[k(Je,{style:{padding:"0"}},{default:m(()=>[g(Me)(e.item.metadata.explicit||!1)?(n(),f(R,{key:0},{default:m(()=>[k(Y,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):y("",!0),u.value?(n(),f(R,{key:1},{default:m(()=>[k(Y,{class:Z(e.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:m(()=>[j("img",{src:g(De),width:"30"},null,8,Oa),k(ve,{activator:"parent",location:"bottom"},{default:m(()=>[A(h(u.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):y("",!0),"track_number"in e.item&&e.item.track_number||"position"in e.item&&e.item.position?(n(),f(R,{key:2},{default:m(()=>[k(Y,{size:"small",icon:"mdi-music-circle-outline"}),e.item.disc_number?(n(),$("span",Ta,h(e.item.disc_number)+"/",1)):y("",!0),A(h(e.item.track_number||e.item.position),1)]),_:1})):y("",!0),g(q)("bp3")?(n(),f(R,{key:3},{default:m(()=>[k(Ze,{item:e.item},null,8,["item"])]),_:1})):y("",!0)]),_:1}),k(Yt),_||e.$vuetify.display.mobile?(n(),f(Re,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:b[0]||(b[0]=G(C=>e.$emit("menu",e.item,C.clientX,C.clientY),["stop"]))})):y("",!0)]),_:2},1024)):y("",!0)]),_:2},1040)),[[w,d]])]),_:1})}}}),Na=te(La,[["__scopeId","data-v-3ea17a69"]]),Ma={setup(o,a){const r=P(()=>({}));return{alertProps:P(()=>({...r.value,...a.attrs}))}}};function Da(o,a,r,u,l,d){return n(),f(zt,U(u.alertProps,{class:"alert",color:"primary",density:"compact",prominent:""}),kt({_:2},[ce(o.$slots,(I,S)=>({name:S,fn:m(()=>[St(o.$slots,S)])}))]),1040)}const Fe=te(Ma,[["render",Da]]),Ra={key:0},Ea={key:1},ja=ee({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(ue.providers).length>1},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1}},setup(o){const a=o,r=$t(),{t:u}=Oe(),l=V({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),d=V("list"),I=V(!1),S=V(!1),e=V([]),b=V([]),w=V(!1),_=V([]),L=V(!1),C=V(!1),N=V(!0),F=V(!1),E=V(!1),ae=V(!1),Qe=function(){I.value?I.value=!1:(I.value=!0,Ie(()=>{var t;(t=document.getElementById("searchInput"))==null||t.focus()}))},le=function(){N.value=!N.value,localStorage.setItem(`expand.${a.path}.${a.itemtype}`,N.value.toString())},oe=function(t){d.value=t,localStorage.setItem(`viewMode.${a.path}.${a.itemtype}`,t)},xe=function(){l.value.favoritesOnly=!l.value.favoritesOnly;const t=l.value.favoritesOnly?"true":"false";localStorage.setItem(`favoriteFilter.${a.path}.${a.itemtype}`,t),T(void 0,void 0,!0)},et=function(){l.value.libraryOnly=!l.value.libraryOnly;const t=l.value.libraryOnly?"true":"false";localStorage.setItem(`libraryFilter.${a.path}.${a.itemtype}`,t),T(!0,void 0,!0)},tt=function(){l.value.albumArtistsFilter=!l.value.albumArtistsFilter;const t=l.value.albumArtistsFilter?"true":"false";localStorage.setItem(`albumArtistsFilter.${a.path}.${a.itemtype}`,t),T(void 0,void 0,!0)},ie=function(t){return _.value.includes(t)},se=function(t,s){if(s)_.value.includes(t)||_.value.push(t);else for(let i=0;i<_.value.length;i++)_.value[i]===t&&_.value.splice(i,1)},at=function(){C.value&&(_.value=[]),C.value=!C.value},lt=function(){T(!0,!0)},X=function(t,s,i){const v=Array.isArray(t)?t:[t];v[0].media_type!=D.FOLDER&&_t(v,a.parentItem,s,i)},ne=function(t,s,i){if(!me(t)){X(t,s,i);return}t.media_type==D.FOLDER?r.push({name:"browse",query:{path:t.path}}):d.value=="list"&&t.media_type==D.TRACK&&a.parentItem?re(t,s,i):r.push({name:t.media_type,params:{itemId:t.item_id,provider:t.provider}})},re=function(t,s,i){if(!me(t)){X(t,s,i);return}if(!O.activePlayerId){O.showPlayersMenu=!0;return}ue.playMedia(t.uri,void 0)},ot=function(){l.value.search="",I.value=!1,T(void 0,void 0,!0)},it=function(t){t!==void 0&&(l.value.sortBy=t),localStorage.setItem(`sortBy.${a.path}.${a.itemtype}`,l.value.sortBy),T(void 0,void 0,!0)},st=function(t){var s,i;(s=l.value.albumType)!=null&&s.includes(t)?l.value.albumType=(i=l.value.albumType)==null?void 0:i.filter(v=>v!==t):(l.value.albumType=l.value.albumType||[],l.value.albumType.push(t)),localStorage.setItem(`albumType.${a.path}.${a.itemtype}`,l.value.albumType.join(",")),T(void 0,void 0,!0)},nt=function(){O.globalSearchTerm=l.value.search,r.push({name:"search"})},rt=function({done:t}){if(F.value){t("empty");return}T(void 0,void 0,void 0,l.value.offset+a.limit).then(()=>{t("ok")})},we=P(()=>{var t=!1;return l.value.search&&l.value.search.length!==0&&(t=!0),t}),ut=P(()=>{var s,i;if(a.allowCollapse===!0&&!N.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:le,overflowAllowed:!1}];const t=[];return a.showSelectButton!==!1&&t.push({label:"tooltip.select_items",icon:C.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:at,active:C.value}),a.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:et,active:l.value.libraryOnly}),a.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:l.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:xe,active:l.value.favoritesOnly}),a.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:l.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:tt,active:l.value.albumArtistsFilter}),a.showAlbumTypeFilter&&t.push({label:"tooltip.album_type",icon:"mdi-album",disabled:w.value,subItems:["album","single","ep","compilation","unknown"].map(v=>{var B;return{label:`album_type.${v}`,selected:(B=l.value.albumType)==null?void 0:B.includes(v),action:()=>{st(v)}}})}),(a.showRefreshButton!==!1||L.value)&&t.push({label:L.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:lt,active:L.value,disabled:w.value}),(s=a.sortKeys)!=null&&s.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:a.sortKeys.length<=1||w.value,subItems:a.sortKeys.map(v=>({label:`sort.${v}`,selected:l.value.sortBy==v,action:()=>{it(v)}}))}),a.showSearchButton!==!1&&t.push({label:we.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Qe,active:we.value,disabled:w.value}),t.push({label:"tooltip.toggle_view_mode",icon:d.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:d.value=="list",action:()=>{oe("list")}},{label:"view.panel",icon:"mdi-grid",selected:d.value=="panel",action:()=>{oe("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:d.value=="panel_compact",action:()=>{oe("panel_compact")}}]}),(i=a.extraMenuItems)!=null&&i.length&&t.push(...a.extraMenuItems),a.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:le}),t}),T=async function(t=!1,s=!1,i=!1,v=0){if(!w.value){if(w.value=!0,i&&a.loadPagedData!=null&&(t=!0),(t||s)&&(v=0,F.value&&(ae.value=!0),F.value=!1,E.value=!1,L.value=!1),l.value.offset=v,l.value.limit=a.limit,l.value.refresh=s,a.loadPagedData!=null){const B=await a.loadPagedData(l.value);l.value.offset?e.value.push(...B):e.value=B,Math.abs(B.length-a.limit)>10&&(F.value=!0)}else if(a.loadItems!=null){(!E.value||s)&&(b.value=await a.loadItems(l.value),E.value=!0);const B=mt(b.value,l.value);l.value.offset?e.value.push(...B):e.value=B,F.value=B.length<a.limit}l.value.refresh=!1,w.value=!1,ae.value=!1}},ct=async function(){const t=`${a.path}.${a.itemtype}`,s=localStorage.getItem(`viewMode.${t}`);s&&s!=="null"?d.value=s:a.itemtype=="artists"||a.itemtype=="albums"?d.value="panel":d.value="list";const i=localStorage.getItem(`sortBy.${t}`);if(i&&i!=="null"&&a.sortKeys.includes(i)?l.value.sortBy=i:l.value.sortBy=a.sortKeys[0],a.showFavoritesOnlyFilter!==!1){const v=localStorage.getItem(`favoriteFilter.${t}`);v&&v=="true"&&(l.value.favoritesOnly=!0)}if(a.showLibraryOnlyFilter!==!1){const v=localStorage.getItem(`libraryFilter.${t}`);v&&v=="true"&&(l.value.libraryOnly=!0)}if(a.showAlbumArtistsOnlyFilter!==!1){const v=localStorage.getItem(`albumArtistsFilter.${t}`);v&&(l.value.albumArtistsFilter=v=="true")}if(a.allowCollapse!==!1){const v=localStorage.getItem(`expand.${t}`);v&&(N.value=v=="true")}if(a.showAlbumTypeFilter===!0){const v=localStorage.getItem(`albumType.${t}`);v&&(l.value.albumType=v.split(","))}if(a.restoreState){let v=`search.${t}`;a.parentItem&&(v+=a.parentItem.item_id);const B=localStorage.getItem(v);B&&B!=="null"&&(l.value.search=B)}},ke=function(t){O.dialogActive||w.value||(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),_.value=e.value,C.value=!0):!S.value&&t.key=="Backspace"?l.value.search=l.value.search.slice(0,-1):!S.value&&t.key.length==1&&(l.value.search+=t.key,I.value=!0))};a.allowKeyHooks&&(document.addEventListener("keydown",ke),Se(()=>{document.removeEventListener("keydown",ke)})),a.restoreState&&Se(()=>{const t=a.path||a.itemtype,s=document.querySelector("#cont");O.prevState={path:t,scrollPos:(s==null?void 0:s.scrollTop)||0,pagedItems:e.value,allItems:b.value,allItemsReceived:F.value,initialDataReceived:E.value,params:l.value}}),z(()=>l.value.search,t=>{t&&(I.value=!0),T(void 0,void 0,!0);let s=`search.${a.path}.${a.itemtype}`;a.parentItem&&(s+=a.parentItem.item_id),localStorage.setItem(s,l.value.search)}),z(()=>a.path,t=>{w.value!=!0&&(e.value=[],b.value=[],T(!0))}),z(()=>a.parentItem,()=>{w.value!=!0&&(b.value=[],L.value=!0)},{deep:!0}),z(()=>a.limit,t=>{l.value.limit=t}),z(()=>a.updateAvailable,t=>{w.value||(L.value=t)},{immediate:!0}),It(async()=>{var s;ct();const t=a.path||a.itemtype;a.restoreState&&((s=O.prevState)==null?void 0:s.path)==t?(l.value=O.prevState.params,e.value=O.prevState.pagedItems,b.value=O.prevState.allItems,F.value=O.prevState.allItemsReceived,E.value=O.prevState.initialDataReceived,Ie(()=>{const i=document.getElementById("cont");i&&Bt(i,O.prevState.scrollPos,50)}),w.value=!1):T(!0)});const M=function(t,s=!1){return t?"label"in t&&t.label&&t.name?u(t.label,[t.name]):"label"in t&&t.label?u(t.label):s&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},mt=function(t,s){var v,B;let i=[];if(s.search){const p=s.search.toLowerCase();for(const c of t)(c.name.toLowerCase().includes(p)||"artist"in c&&((v=c.artist)!=null&&v.name.toLowerCase().includes(p))||"album"in c&&((B=c.album)!=null&&B.name.toLowerCase().includes(p))||"artists"in c&&c.artists&&c.artists.length&&c.artists[0].name.toLowerCase().includes(p))&&i.push(c)}else i=[...t];return s.sortBy=="name"&&i.sort((p,c)=>M(p).localeCompare(M(c),void 0,{numeric:!0})),s.sortBy=="sort_name"&&i.sort((p,c)=>M(p,!0).localeCompare(M(c,!0),void 0,{numeric:!0})),s.sortBy=="name_desc"&&i.sort((p,c)=>M(c).localeCompare(M(p),void 0,{numeric:!0})),s.sortBy=="album"&&i.sort((p,c)=>M(p.album).localeCompare(M(c.album),void 0,{numeric:!0})),s.sortBy=="artist"&&i.sort((p,c)=>M(p.artists[0]).localeCompare(M(c.artists[0]))),s.sortBy=="track_number"&&(i.sort((p,c)=>(p.track_number||0)-(c.track_number||0)),i.sort((p,c)=>(p.disc_number||0)-(c.disc_number||0))),s.sortBy=="position"&&i.sort((p,c)=>(p.position||0)-(c.position||0)),s.sortBy=="position_desc"&&i.sort((p,c)=>(c.position||0)-(p.position||0)),s.sortBy=="year"&&i.sort((p,c)=>(p.year||0)-(c.year||0)),s.sortBy=="recent"&&i.sort((p,c)=>(c.timestamp_added||0)-(p.timestamp_added||0)),s.sortBy=="duration"&&i.sort((p,c)=>(p.duration||0)-(c.duration||0)),s.sortBy=="duration_desc"&&i.sort((p,c)=>(c.duration||0)-(p.duration||0)),s.sortBy=="provider"&&i.sort((p,c)=>p.provider.localeCompare(c.provider)),s.favoritesOnly&&(i=i.filter(p=>p.favorite)),s.albumType&&s.albumType.length>0&&(i=i.filter(p=>{var c;return(c=s.albumType)==null?void 0:c.includes(p.album_type)})),i.slice(s.offset,s.offset+s.limit)};return(t,s)=>t.hideOnEmpty&&e.value.length==0?y("",!0):(n(),$("section",Ra,[k(Wt,{icon:t.icon,title:t.title,count:l.value.search?e.value.length:t.total||b.value.length,color:"transparent","menu-items":ut.value,onTitleClicked:le},null,8,["icon","title","count","menu-items"]),k(Jt),I.value&&N.value?(n(),f(qt,{key:0,id:"searchInput",modelValue:l.value.search,"onUpdate:modelValue":s[0]||(s[0]=i=>l.value.search=i),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:s[1]||(s[1]=i=>S.value=!0),onBlur:s[2]||(s[2]=i=>S.value=!1),"onClick:clear":ot},null,8,["modelValue","label"])):y("",!0),N.value?(n(),f(Ht,{key:1,variant:d.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:m(()=>[!ae.value&&!(e.value.length==0&&F.value)?(n(),f(Zt,{key:0,onLoad:rt,mode:t.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:m(()=>[d.value=="panel"?(n(),f(Ae,{key:0},{default:m(()=>[(n(!0),$($e,null,ce(e.value,i=>(n(),f(_e,{key:i.uri,cols:"12",class:Z(`col-${g(Ce)(t.$vuetify.display.width)}`)},{default:m(()=>[k(Na,{item:i,"is-selected":ie(i),"show-checkboxes":C.value,"show-actions":["tracks","albums"].includes(t.itemtype),onSelect:se,onMenu:X,onClick:ne,onPlay:re},null,8,["item","is-selected","show-checkboxes","show-actions"])]),_:2},1032,["class"]))),128))]),_:1})):y("",!0),d.value=="panel_compact"?(n(),f(Ae,{key:1},{default:m(()=>[(n(!0),$($e,null,ce(e.value,i=>(n(),f(_e,{key:i.uri,cols:"12",class:Z(`col-${g(Ce)(t.$vuetify.display.width)}`)},{default:m(()=>[k(Ut,{item:i,"is-selected":ie(i),"show-checkboxes":C.value,onSelect:se,onMenu:X,onClick:ne,onPlay:re},null,8,["item","is-selected","show-checkboxes"])]),_:2},1032,["class"]))),128))]),_:1})):y("",!0),d.value=="list"?(n(),f(xt,{key:2,"item-height":70,height:"100%",items:e.value,style:{height:"100%",overflow:"hidden"}},{default:m(({item:i})=>[k(Va,{item:i,"show-track-number":t.showTrackNumber,"show-disc-number":t.showTrackNumber,"show-duration":t.showDuration,"show-favorite":t.showFavoritesOnlyFilter,"show-menu":t.showMenu,"show-provider":t.showProvider,"show-album":t.showAlbum,"show-checkboxes":C.value,"is-selected":ie(i),"show-details":t.itemtype.includes("versions"),onSelect:se,onMenu:X,onClick:ne},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","show-details"])]),_:1},8,["items"])):y("",!0)]),_:1},8,["mode","load-more-text"])):y("",!0),!w.value&&e.value.length==0?(n(),$("div",Ea,[!w.value&&e.value.length==0&&(l.value.search||l.value.favoritesOnly)?(n(),f(Fe,{key:0,title:t.$t("no_content_filter")},{default:m(()=>[l.value.search?(n(),f(fe,{key:0,style:{"margin-top":"15px"},onClick:nt},{default:m(()=>[A(h(t.$t("try_global_search")),1)]),_:1})):y("",!0)]),_:1},8,["title"])):!w.value&&e.value.length==0?(n(),f(Fe,{key:1},{default:m(()=>[A(h(t.$t("no_content")),1)]),_:1})):y("",!0)])):y("",!0),k(Qt,{"model-value":_.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:m(()=>[k(fe,{color:"primary",variant:"text",onClick:s[3]||(s[3]=i=>X(_.value,i.clientX,i.clientY))},{default:m(()=>[A(h(t.$t("actions")),1)]),_:1})]),default:m(()=>[j("span",null,h(t.$t("items_selected",[_.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):y("",!0)]))}}),sl=te(ja,[["__scopeId","data-v-da73fbe1"]]);export{sl as I,Ae as V,_e as a,ve as b};
